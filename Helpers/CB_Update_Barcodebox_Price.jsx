/*--------------------------------------------	CB_Update_Barcodebox_Price.jsx  (A CoverBuilder Helper Script)	An InDesign CS6 Javascript      (Tested in CS6)	Version 1.0		Bruno Herfst 2014        This scipts updates the price attached to the barcode for Penguin Books --------------------------------------------*/#target InDesign;var document = app.documents.item(0); // active documentvar myPageItems = toArray(document.allPageItems);var newPrice = prompt('New Price (Leave empty to remove)',"");if(newPrice != null){	newPrice = parseFloat(newPrice).toFixed(2);	if(newPrice == "NaN"){		hideItems = true;	} else {		newPrice = "A$" + newPrice + " RRP";		hideItems = false;	}	var myFilteredItems = selectWhere("BarcodePrice", "label", myPageItems);	changeContent(myFilteredItems, newPrice);}function changeContent(filtered, content){	var i = filtered.length;	while(i--){		if(hideItems){			hideItem(filtered[i]);			filtered[i].contents = content;		} else {			showItem(filtered[i]);			filtered[i].contents = content;		}	}}function selectWhere(value, key, array){    var i = array.length; var t; var filtered = [];    while(i--){    	t = array[i];		if(t && t[key] == value){			filtered.push(t);		}    }    return filtered;}function toArray(objects){    var i = objects.length; var array = [];    while(i--){            array.push(objects[i]);    }    return array;}function showItem(item){	item.transparencySettings.blendingSettings.opacity = 100;}function hideItem(item){	item.transparencySettings.blendingSettings.opacity = 0;}