/*--------------------------------------------	CB_Update_Barcodebox_Category.jsx  (A CoverBuilder Helper Script)	An InDesign CS6 Javascript         (Tested in CS6)	Version 1.0		Bruno Herfst 2014        This scipts updates the category attached to the barcode for Penguin Books --------------------------------------------*/#target InDesign;var document = app.documents.item(0); // active documentvar myPageItems = toArray(document.allPageItems);var catList = [ "OTHER:",				"NO CATEGORY",				"Action & Adventure",				"Africa & Middle East",				"African-American Interest",				"Arts, Architecture, Photography",				"Asia",				"Audiobooks",				"Australia & South Pacific",				"Automotive",				"Award Winners",				"Bestsellers",				"Biography, Autobiography, Memoir",				"Book Club Reading Guides",				"Business & Economics",				"Business/Technical",				"Careers",				"Central America & Caribbean",				"Classics",				"Computers & the Internet",				"Cooking, Food, Drink",				"Ebooks",				"Entertainment",				"Europe & Russia",				"Fantasy",				"Fiction",				"For Ages 0-3",				"For Ages 10-Up",				"For Ages 4-6",				"For Ages 7-9",				"General",				"Health, Fitness, Beauty",				"History",				"Hobbies, Puzzle, & Games",				"Home & Garden",				"Latino Interest",				"Literary",				"Management",				"Mind, Body, Spirit",				"Mystery",				"Nonfiction",				"North America",				"Penguin Classics",				"Performing Arts",				"Philosophy",				"Reference",				"Religion, Spirituality",				"Romance",				"Science & Nature",				"Science Fiction",				"Short Reads",				"South America",				"Special Interest",				"Sports",				"Suspense & Thrillers",				"Travel",				"Travel Writing",				"Upcoming Books",				"Western",				"Young Readers"];// Make the dialog boxvar the_dialog = app.dialogs.add({name:"Change barcode category"});with(the_dialog.dialogColumns.add()){	with(dialogRows.add()){		var chooseCat = dropdowns.add({stringList:catList, selectedIndex:0});	}	with(dialogRows.add()){		staticTexts.add({staticLabel:"Category:"});		var newCatInput = textEditboxes.add({editContents:"",minWidth:200});	}}//the_dialog.show();if(the_dialog.show() == true){	var i = chooseCat.selectedIndex;	if(i > 1){		newCat = catList[i];	} else if(i == 0) {		newCat = newCatInput.editContents;	} else {		newCat = "";	}	if(newCat != null){		if(newCat == ""){			hideItems = true;		} else {			hideItems = false;		}		var myFilteredItems = selectWhere("BarcodeCat", "label", myPageItems);		changeContent(myFilteredItems, newCat);	}}else{	the_dialog.destroy();	exit;}function changeContent(filtered, content){	var i = filtered.length;	while(i--){		if(hideItems){			hideItem(filtered[i]);			filtered[i].contents = content;		} else {			showItem(filtered[i]);			filtered[i].contents = content;		}	}}function selectWhere(value, key, array){    var i = array.length; var t; var filtered = [];    while(i--){    	t = array[i];		if(t && t[key] == value){			filtered.push(t);		}    }    return filtered;}function toArray(objects){    var i = objects.length; var array = [];    while(i--){            array.push(objects[i]);    }    return array;}function showItem(item){	item.transparencySettings.blendingSettings.opacity = 100;}function hideItem(item){	item.transparencySettings.blendingSettings.opacity = 0;}