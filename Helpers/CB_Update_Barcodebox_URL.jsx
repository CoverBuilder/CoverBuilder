/*--------------------------------------------	CB_Update_Barcodebox_URL.jsx    (A CoverBuilder Helper Script)	An InDesign CS5 Javascript      (Tested in CS6)	Version 1.0		Bruno Herfst 2013        This scipts replaces the barcode URL on covers build with CoverBuilder    for Allen & Unwin or Penguin Books --------------------------------------------*/#target InDesign;var document = app.documents.item(0); // active documentvar myPageItems = toArray(document.allPageItems);var newURL = prompt('New barcode URL','');if(newURL != null){	var myFilteredItems = selectWhere("BarcodeURL", "label", myPageItems);	changeContent(myFilteredItems, newURL);}function changeContent(filtered, content){	var i = filtered.length;	while(i--){		filtered[i].contents = content;	}}function selectWhere(value, key, array){    var i = array.length; var t; var filtered = [];    while(i--){    	t = array[i];		if(t && t[key] == value){			filtered.push(t);		}    }    return filtered;}function toArray(objects){    var i = objects.length; var array = [];    while(i--){            array.push(objects[i]);    }    return array;}